<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Test Interactivo: ¿Eres el CEO de tu cuerpo?</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --quiz-font: "Inter", sans-serif;
        --quiz-bg-overlay: rgba(17, 24, 39, 0.85);
        --quiz-bg-modal: #1f2937; /* Tailwind bg-gray-800 */
        --quiz-text-light: #f3f4f6; /* Tailwind bg-gray-200 */
        --quiz-text-medium: #9ca3af; /* Tailwind bg-gray-400 */
        --quiz-primary: #3b82f6; /* Tailwind bg-blue-600 */
        --quiz-primary-hover: #2563eb; /* Tailwind bg-blue-700 */
        --quiz-green: #16a34a; /* Tailwind bg-green-600 */
        --quiz-green-hover: #15803d; /* Tailwind bg-green-700 */
      }
      .quiz-body {
        font-family: var(--quiz-font);
      }
      .quiz-start-button-container {
        text-align: center;
        padding: 2.5rem;
      }
      .quiz-start-button {
        background-image: linear-gradient(to right, #3b82f6, #1e40af);
        color: white;
        font-weight: bold;
        padding: 1rem 2.5rem;
        border-radius: 0.5rem;
        font-size: 1.25rem;
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1),
          0 4px 6px -2px rgba(0, 0, 0, 0.05);
        transition: all 0.3s ease-in-out;
        border: none;
        cursor: pointer;
      }
      .quiz-start-button:hover {
        transform: translateY(-4px);
        box-shadow: 0 20px 25px -5px rgba(59, 130, 246, 0.3),
          0 10px 10px -5px rgba(59, 130, 246, 0.2);
      }
      #quiz-main-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: var(--quiz-bg-overlay);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        color: white;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999999;
        padding: 1rem;
        opacity: 0;
        transition: opacity 0.3s ease-in-out;
        pointer-events: none;
      }
      #quiz-main-container.visible {
        opacity: 1;
        pointer-events: auto;
      }
      .quiz-content-wrapper {
        width: 100%;
        max-width: 42rem; /* max-w-2xl */
        background-color: var(--quiz-bg-modal);
        border-radius: 0.75rem; /* rounded-xl */
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        padding: 2.5rem;
        position: relative;
        max-height: 90vh;
        overflow-y: auto;
      }
      .quiz-screen {
        transition: opacity 0.5s ease-in-out;
      }
      .quiz-screen.hidden {
        display: none;
      }
      .quiz-screen h1 {
        font-size: 2.25rem; /* text-3xl */
        line-height: 2.5rem;
        font-weight: 700;
        color: var(--quiz-text-light);
        margin-bottom: 0.75rem;
      }
      .quiz-screen h2 {
        font-size: 1.875rem; /* text-2xl */
        line-height: 2.25rem;
        font-weight: 600;
        color: var(--quiz-primary);
        margin-bottom: 1.5rem;
      }
      .quiz-screen h3 {
        font-size: 1.875rem; /* text-2xl */
        line-height: 2.25rem;
        font-weight: 700;
        margin-bottom: 1rem;
      }
      .quiz-screen p {
        color: var(--quiz-text-medium);
      }
      .quiz-textarea {
        width: 100%;
        height: 8rem;
        background-color: #374151; /* bg-gray-700 */
        color: white;
        padding: 1rem;
        border-radius: 0.5rem;
        border: 2px solid #4b5563; /* border-gray-600 */
        transition: border-color 0.2s ease, box-shadow 0.2s ease;
      }
      .quiz-textarea:focus {
        outline: none;
        border-color: var(--quiz-primary);
        box-shadow: 0 0 0 2px var(--quiz-primary);
      }
      .quiz-nav-button {
        background-color: var(--quiz-primary);
        color: white;
        font-weight: 700;
        padding: 0.75rem 2rem;
        border-radius: 0.5rem;
        transition: transform 0.2s ease, background-color 0.2s ease;
        border: none;
        cursor: pointer;
      }
      .quiz-nav-button:hover {
        background-color: var(--quiz-primary-hover);
        transform: scale(1.05);
      }
      .quiz-nav-button:disabled {
        background-color: #4b5563; /* bg-gray-600 */
        opacity: 0.5;
        cursor: not-allowed;
      }
      .quiz-nav-button:disabled:hover {
        transform: none;
      }
      .quiz-back-button {
        color: var(--quiz-text-medium);
        font-weight: 700;
        padding: 0.5rem 1rem;
        border-radius: 0.5rem;
        border: none;
        background: transparent;
        cursor: pointer;
      }
      .quiz-back-button:hover {
        background-color: rgba(255, 255, 255, 0.1);
      }
      .quiz-button-container {
        margin-top: 1.5rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .quiz-button-container.end-only {
        justify-content: flex-end;
      }
      @media (max-width: 640px) {
        .quiz-content-wrapper {
          padding: 1.5rem;
        }
        .quiz-screen h1 {
          font-size: 1.75rem;
          line-height: 2rem;
        }
        .quiz-screen h2 {
          font-size: 1.5rem;
          line-height: 1.75rem;
        }
        .quiz-screen h3 {
          font-size: 1.5rem;
          line-height: 1.75rem;
        }
        .quiz-start-button {
          font-size: 1rem;
          padding: 0.75rem 1.5rem;
        }
      }
    </style>
  </head>
  <body>
    <!-- Pantalla 0: Botón de Inicio -->
    <div id="start-button-container" class="quiz-start-button-container">
      <button id="startQuizBtn" class="quiz-start-button">
        Haz el Test Ahora y Descubre tu Energía Real
      </button>
    </div>

    <!-- Contenedor del Quiz Modal (inicialmente oculto) -->
    <div id="quiz-main-container" class="hidden">
      <div id="quiz-content-wrapper" class="quiz-content-wrapper">
        <!-- Pantalla 1: Introducción -->
        <div id="screen-1" class="quiz-screen">
          <div style="text-align: center">
            <h1>¿Eres el CEO de tu cuerpo...</h1>
            <h2>o solo un asistente agotado?</h2>
            <div
              style="
                max-width: 28rem;
                margin: 2rem auto;
                text-align: left;
                display: flex;
                flex-direction: column;
                gap: 0.75rem;
              "
            >
              <p>
                <span style="color: var(--quiz-secondary); font-weight: bold"
                  >✓</span
                >
                Descubre qué está drenando tu energía.
              </p>
              <p>
                <span style="color: var(--quiz-secondary); font-weight: bold"
                  >✓</span
                >
                Entiende qué necesita tu cuerpo HOY.
              </p>
              <p>
                <span style="color: var(--quiz-secondary); font-weight: bold"
                  >✓</span
                >
                Recibe un biohack natural para aplicar de inmediato.
              </p>
            </div>
            <p style="margin-bottom: 2rem">
              🧠 Solo 3 preguntas. Resultados en menos de 2 minutos.
            </p>
            <button
              onclick="showScreen(2)"
              class="quiz-nav-button"
              style="padding: 0.75rem 3rem; font-size: 1.125rem"
            >
              👉 Empieza ahora
            </button>
          </div>
        </div>

        <!-- Pantalla 2: Pregunta 1 -->
        <div id="screen-2" class="quiz-screen hidden">
          <p
            style="
              color: var(--quiz-secondary);
              font-weight: 600;
              margin-bottom: 0.5rem;
            "
          >
            Pregunta 1/4
          </p>
          <h3>¿Cómo te sientes energéticamente durante un día típico?</h3>
          <textarea
            id="answer1"
            oninput="validateInput('answer1', 'nextBtn2')"
            class="quiz-textarea"
            placeholder="Ej: “Empiezo bien pero me apago a media tarde”, “Duermo bien, pero sigo cansado/a”, “Solo funciono con café”..."
          ></textarea>
          <div class="quiz-button-container end-only">
            <button
              id="nextBtn2"
              onclick="showScreen(3)"
              class="quiz-nav-button"
              disabled
            >
              Siguiente
            </button>
          </div>
        </div>

        <!-- Pantalla 3: Pregunta 2 -->
        <div id="screen-3" class="quiz-screen hidden">
          <p
            style="
              color: var(--quiz-secondary);
              font-weight: 600;
              margin-bottom: 0.5rem;
            "
          >
            Pregunta 2/4
          </p>
          <h3>¿Qué hábitos logras sostener... y cuáles no?</h3>
          <textarea
            id="answer2"
            oninput="validateInput('answer2', 'nextBtn3')"
            class="quiz-textarea"
            placeholder="Ej: “Entreno a diario, pero como mal”, “Suplemento a veces, sin orden”, “No tengo rutina clara”..."
          ></textarea>
          <div class="quiz-button-container">
            <button onclick="showScreen(2)" class="quiz-back-button">
              Anterior
            </button>
            <button
              id="nextBtn3"
              onclick="showScreen(4)"
              class="quiz-nav-button"
              disabled
            >
              Siguiente
            </button>
          </div>
        </div>

        <!-- Pantalla 4: Pregunta 3 -->
        <div id="screen-4" class="quiz-screen hidden">
          <p
            style="
              color: var(--quiz-secondary);
              font-weight: 600;
              margin-bottom: 0.5rem;
            "
          >
            Pregunta 3/4
          </p>
          <h3>¿Qué te gustaría mejorar en tu cuerpo o mente ahora mismo?</h3>
          <textarea
            id="answer3"
            oninput="validateInput('answer3', 'nextBtn4')"
            class="quiz-textarea"
            placeholder="Ej: “Tener más foco mental”, “Dormir bien sin ansiedad”, “Sentirme más liviano/a y enfocado/a”..."
          ></textarea>
          <div class="quiz-button-container">
            <button onclick="showScreen(3)" class="quiz-back-button">
              Anterior
            </button>
            <button
              id="nextBtn4"
              onclick="showScreen(5)"
              class="quiz-nav-button"
              disabled
            >
              Siguiente
            </button>
          </div>
        </div>

        <!-- Pantalla 5: Pregunta 4 (Opcional) -->
        <div id="screen-5" class="quiz-screen hidden">
          <p
            style="
              color: var(--quiz-secondary);
              font-weight: 600;
              margin-bottom: 0.5rem;
            "
          >
            Pregunta 4/4 (Opcional)
          </p>
          <h3>¿En qué momento del día sientes que se cae tu energía?</h3>
          <textarea
            id="answer4"
            class="quiz-textarea"
            placeholder="Ej: “A media tarde”, “Después de comer”, “En la noche, no logro apagarme”..."
          ></textarea>
          <div class="quiz-button-container">
            <button onclick="showScreen(4)" class="quiz-back-button">
              Anterior
            </button>
            <button
              id="nextBtn5"
              onclick="sendDataAndRedirect()"
              class="quiz-nav-button"
              style="
                background-color: var(--quiz-green);
                padding: 0.75rem 2.5rem;
                font-size: 1.125rem;
              "
            >
              Ver mis resultados
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
      // --- LÓGICA PRINCIPAL DEL QUIZ ---

      function showScreen(screenNumber) {
        const screens = document.querySelectorAll(".quiz-screen");
        screens.forEach((s) => s.classList.add("hidden"));
        const nextScreen = document.getElementById(`screen-${screenNumber}`);
        if (nextScreen) {
          nextScreen.classList.remove("hidden");
        }
      }

      function validateInput(textareaId, buttonId) {
        const textarea = document.getElementById(textareaId);
        const button = document.getElementById(buttonId);
        if (button) {
          button.disabled = textarea.value.trim() === "";
        }
      }

      async function sendDataAndRedirect() {
        const webhookURL =
          "https://hook.us2.make.com/qq66gdowwxywndlthvfahclujongysln";
        const finalButton = document.getElementById("nextBtn5");

        const data = {
          pregunta1: document.getElementById("answer1").value.trim(),
          pregunta2: document.getElementById("answer2").value.trim(),
          pregunta3: document.getElementById("answer3").value.trim(),
          pregunta4: document.getElementById("answer4").value.trim(),
        };

        if (finalButton) {
          finalButton.disabled = true;
          finalButton.innerText = "Analizando...";
        }

        try {
          await fetch(webhookURL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data),
          });
        } catch (error) {
          console.error("Error en la solicitud fetch:", error);
        } finally {
          window.location.href =
            "https://soulinmotion.empoderamientoesencial.com/thanks-page";
        }
      }

      // --- CÓDIGO DE INICIALIZACIÓN Y CORRECCIÓN PARA GOHIGHLEVEL ---
      document.addEventListener("DOMContentLoaded", () => {
        const startButton = document.getElementById("startQuizBtn");
        const quizModal = document.getElementById("quiz-main-container");
        const startButtonContainer = document.getElementById(
          "start-button-container"
        );

        if (startButton && quizModal && startButtonContainer) {
          // Mueve el modal al body para escapar de los contenedores de GHL
          document.body.appendChild(quizModal);

          startButton.addEventListener("click", () => {
            startButtonContainer.style.display = "none";
            quizModal.classList.remove("hidden");
            setTimeout(() => {
              quizModal.classList.add("visible");
            }, 10); // Pequeño delay para que la transición CSS se aplique
            showScreen(1);
          });
        }
      });
    </script>
  </body>
</html>
